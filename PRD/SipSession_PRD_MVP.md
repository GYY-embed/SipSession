# SipSession PRD（MVP，iPhone + Apple Watch）

日期：2026-02-03  
版本：MVP

---

## 1. Executive Summary

**Problem Statement**  
目前没有一款把「饮酒记录 + 心率趋势 + 恢复建议」整合在一起、可复盘的应用，导致用户只能凭记忆回想每杯时间、数量和身体状态。

**Proposed Solution**  
提供 iPhone+Apple Watch 的酒局过程记录器：Watch 端高频记录与实时心率，iPhone 端配置、控制与报告生成，结束后给出可复盘的统计与恢复时间区间。

**Success Criteria（上线 4 周内）**  
- 酒局记录数量（Session Count）达到自定目标基线（TBD：目标数值）。  
- 周均使用频率（Sessions/Active User/Week）达到自定目标基线（TBD）。  
- 记录分享次数/分享率达到自定目标基线（TBD）。  
- Session 完成率（有结束时间的 Session / 总 Session）≥ 80%。  
- Watch 端记录成功率（成功写入 DrinkLog 的点击 / 点击）≥ 98%。

---

## 2. User Experience & Functionality

### User Personas
- 轻到中度饮酒用户，拥有 Apple Watch，希望低操作成本记录酒局并在结束后复盘。

### User Stories
1) 作为饮酒用户，我希望一键开始酒局并在 Watch 上逐杯记录，这样我不会忘记每杯时间和数量。  
2) 作为饮酒用户，我希望查看实时心率趋势，这样我能了解身体状态变化。  
3) 作为饮酒用户，我希望结束后看到可信的统计与恢复区间，这样我能有复盘依据。  
4) 作为饮酒用户，我希望在 iPhone 上管理常用饮品模板（如啤酒 330ml、白酒 15ml 等），这样记录更准确。  
5) 作为饮酒用户，我希望在任何端都能暂停/继续/结束，这样控制更灵活。  
6) 作为饮酒用户，我希望把酒局报告以图片形式保存到相册，这样更方便分享和传播。  
7) 作为饮酒用户，我希望在酒局进行中用 iPhone 微调已记录的单杯信息（杯量/酒精度/名称），这样数据更准确。
8) 作为饮酒用户，我希望 iPhone 或 Watch 都能独立开局，并在需要时由 iPhone 接管当前酒局进行配置调整。
9) 作为饮酒用户，我希望设置头像与名称，并在报告中展示，便于识别与分享。

### Acceptance Criteria
**Story 1（开始与记录）**  
- iPhone 端可一键开始酒局，默认进入「进行中」页面。  
- Watch 端支持 `+1` 计杯，默认饮品可切换但不可编辑。  
- 每次计杯写入 DrinkLog，并附带记录时心率窗口统计（平均或峰值）。  

**Story 2（心率展示）**  
- Watch 端开启 Workout Session（或等效机制）以获取高频心率样本。  
- Watch 中间页展示实时心率与趋势（↑/→/↓）。  

**Story 3（结束与报告）**  
- 结束后 10–30 秒内进入 Watch 简要汇总页。  
- iPhone 自动生成酒局报告并展示：杯数、酒精 g、液体 ml、排尿次数、时长、心率摘要、恢复区间与免责声明。  

**Story 4（饮品模板）**  
- MVP 预置 5 种模板与默认杯量：啤酒 330ml、烈酒 15ml、葡萄酒 80ml、鸡尾酒 150ml、软饮 250ml。  
- 开始酒局前选择本次可用酒类（可多选），并同步到 Watch。  
- iPhone 端可在开局时临时调整杯量（不修改默认模板）。  
- Watch 端仅使用默认模板杯量，不支持临时调整。  
- 面向用户的入口文案统一为“喝点什么”（开局与酒局中配置）。  
- 酒局进行中 iPhone 可调整模板配置（仅影响后续记录）：  
  - 允许切换默认饮品。  
  - 允许新增一个饮品模板进入本次可选列表。  
  - 允许调整默认容量/ABV（仅影响后续记录）。  
  - 不允许删除正在使用的模板。  

**Story 5（跨端控制）**  
- iPhone 与 Watch 均可暂停/继续/结束，状态双向同步。  
- 任一端结束后，Session 进入终态，不能再次恢复 active。  

**Story 6（报告分享）**  
- iPhone 端支持将酒局报告生成图片并保存到系统相册。  
- 图片模板支持多种样式（MVP 至少 1–2 种，后续可扩展）。  
- 模板可包含心率曲线图，并在曲线上标注饮酒/排尿事件点。  
- 图片下方展示核心统计数据（杯数、酒精 g、液体 ml、排尿次数、时长、心率摘要、恢复区间）。  

**Story 7（酒局中微调单杯）**  
- 仅在酒局进行中，iPhone 端可对已记录的单杯进行微调：杯量、酒精度、名称（可选）。  
- Watch 端不支持修改，仅负责计数与记录。  
- 微调后需触发总量与统计重算，并更新报告与分享图数据源。  

**Story 8（开局与接管）**  
- Watch 支持独立开局；若未收到 iPhone 配置，使用 Fallback 模板列表。  
- iPhone 支持独立开局，并同步本次模板配置到 Watch。  
- iPhone 任何时候打开均可接管当前 Session，并进行模板配置调整。  
- 双端控制保持同步，结束原因可追溯（`ended_reason`）。  

**Story 9（头像与名称）**  
- iPhone 端支持设置头像与名称。  
- 报告中展示头像与名称。  

### Non-Goals
- 不做“还能喝多少”“是否安全驾驶”等安全/医疗判断。  
- 不做自动排尿识别。  
- 不做复杂心率图表，仅做趋势与摘要。  
- 不做社交平台一键发布（MVP 仅保存到相册）。  
- 不做 iPhone 端饮酒记录（MVP 仅 Watch 端记录）。  
- 不支持酒局结束后在报告中微调单次饮酒量（MVP）。  
- 不支持用户自定义饮品模板或图标（MVP）。  

---

## 3. AI System Requirements (If Applicable)

不适用（MVP 不包含 AI 生成或模型决策）。如后续加入智能建议，需单独补充本节。

---

## 4. Technical Specifications

### Architecture Overview
- Watch 端负责高频事件记录与心率采集。  
- iPhone 端负责配置、控制与报告生成。  
- 双端通过本地存储 + 同步事件合并；以最新事件时间为准。  

### Integration Points
- HealthKit：获取心率样本（Workout Session 或等效方式）。  
- 本地存储：Session、DrinkLog、PeeLog、模板数据（本地优先）。  
- 相册：保存分享图片到系统相册（本地权限）。  

### Security & Privacy
- 仅本地存储（当前版本不上传云端）。  
- 心率数据用于显示与统计，不作为医疗结论。  
- 若后续引入云同步或分享，需补充隐私政策与合规要求（TBD）。  

---

## 5. Risks & Roadmap

### Phased Rollout
- **MVP**：基础记录、心率趋势、报告与恢复区间、自动结束兜底。  
- **v1.1（TBD）**：Live Activity 常驻入口、报告可视化增强、用户自定义饮品模板与图标。  
- **v2.0（TBD）**：跨设备云同步、分享模板与更丰富统计。  

### Technical Risks
- HealthKit 心率采样中断或离腕导致数据缺失。  
- 双端离线与同步冲突导致状态不一致。  
- 自动结束逻辑触发过早影响用户体验。  
- 分享图片模板样式与数据可视化质量不一致，影响传播效果。  
- 单杯微调引发的重算与一致性问题（总量、报告、分享图需同步）。  

---

## 6. 商业化与定价（规划）

- **MVP/TestFlight 阶段**：不收费。  
- **核心功能承诺**：核心记录与 Watch 功能永远不作为付费门槛。  
- **可能的付费方向（后续版本）**：  
  - 更多报告生成模板。  
  - 高级分析与对比（历史酒局数据、周/月/年统计）。  
  - 数据导出。  
  - 个性化参数（如自定义饮品添加）。  
- **计费方式**：不做订阅，优先考虑一次性买断。  

---

## 7. 页面定义

### iPhone / 开局 / 酒局开始
页面目的：
- 快速开始酒局并完成本次可用饮品选择
进入条件：
- 用户点击「开始酒局」
展示内容：
- 预置 5 种饮品与默认杯量
- 本次可用酒类选择（可多选）
可执行操作：
- 开始酒局
- 选择本次饮品（多选）
- 临时调整杯量（不改默认模板）
不支持的操作：
- 自定义新增饮品模板（MVP 不支持）
备注：
- 选择结果需同步到 Watch

### iPhone / 酒局进行中 / 状态与控制
页面目的：
- 展示当前酒局状态并提供控制入口
进入条件：
- 酒局开始后自动进入；或从任意入口返回当前 Session
展示内容：
- 已进行时间、杯数、酒精 g、液体 ml、排尿次数
- 当前/最近心率（来自 Watch）
可执行操作：
- 暂停/继续
- 结束酒局（二次确认）
不支持的操作：
- iPhone 端直接记一杯（MVP 不支持）
备注：
- iPhone 可随时接管当前 Session

### iPhone / 酒局进行中 / 喝点什么
页面目的：
- 在酒局过程中调整本次可用饮品配置（仅影响后续记录）
进入条件：
- 进行中页面点击「喝点什么」
展示内容：
- 本次可用饮品列表与默认饮品
- 预置饮品候选列表
可执行操作：
- 切换默认饮品
- 从预置列表新增一种饮品进本次列表
- 调整默认容量/ABV（仅影响后续记录）
不支持的操作：
- 删除正在使用的模板
- 自定义新增饮品（MVP 不支持）
备注：
- 调整后需同步到 Watch

### iPhone / 酒局进行中 / 单杯微调
页面目的：
- 提升记录准确性，对已记录单杯进行微调
进入条件：
- 进行中页面进入「记录列表/单杯详情」
展示内容：
- 单杯时间、饮品名称、杯量、ABV、酒精克数
可执行操作：
- 微调杯量/酒精度/名称（仅进行中）
不支持的操作：
- 结束后在报告内微调（MVP 不支持）
备注：
- 保存后触发总量与报告数据重算

### iPhone / 报告 / 酒局报告详情
页面目的：
- 提供酒局复盘与恢复区间建议
进入条件：
- 酒局结束后自动进入；或从历史列表进入
展示内容：
- 概览数据、心率摘要、恢复区间与免责声明
 - 头像与名称
可执行操作：
- 生成分享图片并保存到相册
不支持的操作：
- 报告内修改饮酒记录（MVP 不支持）
备注：
- 分享模板支持 1–2 种样式（MVP）

### iPhone / 历史 / 酒局列表
页面目的：
- 快速回看历史 Session
进入条件：
- 从首页或报告返回历史入口
展示内容：
- 按时间排序的 Session 列表（时间、杯数、时长等摘要）
可执行操作：
- 进入单次报告详情
不支持的操作：
- 批量编辑/删除（MVP 不支持）

### iPhone / 个人 / Profile
页面目的：
- 统一入口管理个人资料与应用配置
进入条件：
- 从应用主入口进入个人页
展示内容：
- 头像、名称摘要
- 入口：模板配置 / 程序设置 / 头像与名称
可执行操作：
- 进入各子页面
不支持的操作：
- 无

### iPhone / 个人 / 头像与名称
页面目的：
- 配置个人展示信息用于报告与分享
进入条件：
- Profile 页面进入
展示内容：
- 当前头像与名称
可执行操作：
- 上传头像
- 设置名称
不支持的操作：
- 无
备注：
- 头像与名称用于报告展示

### iPhone / 个人 / 模板配置
页面目的：
- 查看与管理预置模板的基础信息
进入条件：
- Profile 页面进入
展示内容：
- 5 种预置模板与默认杯量/ABV
可执行操作：
- 设置默认饮品
不支持的操作：
- 自定义新增模板（MVP 不支持）
备注：
- 仅影响后续开局默认选择

### iPhone / 个人 / 程序设置
页面目的：
- 管理应用通用设置
进入条件：
- Profile 页面进入
展示内容：
- 通用设置项（TBD）
可执行操作：
- 修改设置项（TBD）
不支持的操作：
- 无
备注：
- 具体设置项后续补充

### Watch / 开局 / 默认入口
页面目的：
- 快速开始酒局
进入条件：
- Watch 打开应用且无进行中 Session
展示内容：
- 简单开始按钮
可执行操作：
- 点击开始酒局（使用 Fallback 模板）
不支持的操作：
- 模板编辑或微调

### Watch / 酒局 / 记录页（中间页）
页面目的：
- 以最低操作成本完成计杯与心率查看
进入条件：
- 酒局开始后默认进入
展示内容：
- 实时心率与趋势
- 默认饮品与计数按钮
可执行操作：
- `+1` 计杯
- 切换默认饮品（从本次列表中选择）
- `🚻 +1` 排尿记录
不支持的操作：
- 修改杯量/ABV/名称
备注：
- 仅使用默认模板杯量

### Watch / 酒局 / 控制页（左页）
页面目的：
- 提供低频控制入口
进入条件：
- 左滑进入
展示内容：
- 当前状态（进行中/暂停）
可执行操作：
- 暂停/继续
- 结束酒局（二次确认）
不支持的操作：
- 模板编辑与微调

### Watch / 酒局 / 汇总页（右页）
页面目的：
- 快速查看当前累计状态
进入条件：
- 右滑进入
展示内容：
- 杯数、酒精 g、液体 ml、排尿次数、已进行时间
可执行操作：
- 无
不支持的操作：
- 任何编辑/控制

### Watch / 酒局 / 结束简要汇总
页面目的：
- 结束后快速确认本次概览
进入条件：
- 任一端结束或自动结束触发
展示内容：
- 杯数、酒精 g、排尿次数、时长
- “在 iPhone 查看完整报告”提示
可执行操作：
- 完成/退出
不支持的操作：
- 修改数据
备注：
- 展示 10–30 秒或用户主动退出

---

## 附录：核心功能清单（MVP）

### Watch（3 页结构）
- 中间页：实时心率、趋势、`+1` 计杯、饮品切换、`🚻 +1` 排尿记录。  
- 左页：暂停/继续，结束（二次确认）。  
- 右页：杯数、酒精 g、液体 ml、排尿次数、已进行时间。  

### 自动结束机制（兜底）
- 目的：覆盖“喝过量忘记关闭”或“中途离开未结束”的场景，保证 Session 数据完整性与可用性。  
- 连续 15 分钟无记录提示；无响应 15/30/45 分钟自动结束。  
- 离腕 5–10 分钟未恢复自动结束。  
- 记录 ended_reason：`auto_timeout` / `off_wrist`。  

### iPhone
- 开始酒局与配置模板。  
- 进行中页面：只读展示 + 控制按钮。  
- 结束后生成报告 + 历史列表。  
- 生成分享图片并保存到相册（多模板样式）。  
- 酒局进行中可微调已记录单杯信息（杯量/酒精度/名称）。  

### 数据模型（必须字段）
- DrinkTemplate：`id, name, type, abv, default_volume_ml, icon_key?`  
- Session：`id, start_time, end_time, state, ended_reason, totals, heart_rate_summary, selected_template_ids`  
- DrinkLog：`id, session_id, timestamp, template_id, volume_ml, abv, alcohol_grams, custom_name?, hr_window_avg_bpm?, hr_window_max_bpm?`  
- PeeLog：`id, session_id, timestamp, hr_at_log_bpm?`  
- UserProfile：`id, display_name, avatar_image_uri`  
